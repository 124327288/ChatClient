<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">
<html>
<head>
    <meta name="qrichtext" content="1" />
    <style type="text/css">p, li { white-space: pre-wrap; }</style>
    <script src="./qwebchannel.js"></script>
</head>
<body style=" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;" onload="window.scrollTo(0,document.body.scrollHeight); " >
    <div id = "dv"></div>
    <script>
    new QWebChannel(qt.webChannelTransport, function(channel) {
       window.connect = channel.objects.connect;
       connect.AddContent.connect(addContent);
       connect.AddFileDesc.connect(addFileDesc);
    });
    function openFile(path){
        if(connect){
            connect.OpenFile(path);
        }
    }
    function openFolder(path){
        if(connect){
            connect.OpenFolder(path);
        }
    }
    function addMsgHeader(header, parent){
        var elemTitle = document.createElement("p");
        var nodeTitle = document.createTextNode(header);
        elemTitle.appendChild(nodeTitle);
        elemTitle.style.color = "blue";
        parent.appendChild(elemTitle);
    }
    function addContent(title, msg){
        var elemDiv = document.createElement("div");

        addMsgHeader(title, elemDiv);

        var elemMsg = document.createElement("div");
        elemMsg.innerHTML = msg;
        elemDiv.appendChild(elemMsg);

        document.getElementById("dv").appendChild(elemDiv);
        window.scrollTo(0, document.body.scrollHeight);
    }
    function addFileDesc(title, fileName, filePath, folderPath){
        var elemDiv = document.createElement("div");
        addMsgHeader(title, elemDiv);
        var elemFile = _addFileDesc(fileName, filePath, folderPath);
        elemDiv.appendChild(elemFile);
        document.getElementById("dv").appendChild(elemDiv);
        window.scrollTo(0, document.body.scrollHeight);
    }
    function _addFileDesc(fileName, filePath, folderPath){
        var elemFile = document.createElement("p");
        var txtNode = document.createTextNode(fileName);
        elemFile.appendChild(txtNode);
        elemFile.appendChild(document.createTextNode("  "));
        var elemOf = document.createElement("a");
        var nodeof = document.createTextNode("打开文件");
        elemOf.appendChild(nodeof);
        elemOf.setAttribute("href", "javascript:openFile('"+filePath+"')");
        elemFile.appendChild(elemOf);
        elemFile.appendChild(document.createTextNode("  "));
        var elemocf = document.createElement("a");
        var nodeocf = document.createTextNode("打开文件夹");
        elemocf.appendChild(nodeocf);
        elemocf.setAttribute("href", "javascript:openFolder('"+folderPath+"')");
        elemFile.appendChild(elemocf);
        return elemFile;
    }
    </script>
</body>
</html>